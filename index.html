<!DOCTYPE html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8">
	<title>GO, by Ishmael</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
	<script src="ish.go.js"></script>
	<script src="ish.go.logic.js"></script>
	<script src="ish.go.view.h5.js"></script>
	<script>
		function setDesc() {
			let text;
			let desc = prompt("Please enter your desc:", "Harry Potter");
			if (desc == null || desc == "") {
				text = "User cancelled the prompt.";
			} else {
				//set description
				Ish.Go.View.setDescription(desc);
				//push current step to history
				//gGameState.boardHistory.push(gGameState.getBoardCopy);
				//console log for copy and paste
				console.log(gGameState.boardHistory);
			}
			};

		$(document).keypress(function(e){

		//left 'arrow' (lesser than)
		if (e.which == 60){
			Ish.Go.View.recall(1);
		}
		//right 'arrow' (greater than)
		if (e.which == 62){
			Ish.Go.View.nextCall(1);
		}
		//p
		if (e.which == 112){
			Ish.Go.View.printDescription();
		}
		//s
		if (e.which == 115){
			setDesc();
		}
		});
	</script>
	<link rel="stylesheet" href="style-h5.css" />
</head> 
<body>
	
	<div id="gameSection">
		<div id="board"></div>
		
		<div id="info">
			<div id="turn"></div>
			<br>
			<div id="score"></div>
			<br>
			<div id="coords"></div>
			<br>
			<div id="point"></div>
		</div>
		
		<div class="clear"></div>
	</div>	
	
	<div id="devSection">
		<div>
			<span id="toggleLink" class="link" onclick="$('#devTools').slideToggle()">[Toggle Developer Tools]</span>
		</div>
		<div id="devTools">
			<ul id="devActions">
				<li class="link" onclick="Ish.Go.View.startNewGame()">New Game</li>
				<li class="link" onclick="$('#score').toggle()">Toggle Scores</li>
				<li class="link" onclick="Ish.Go.View.toggleMarkedBoard()">Toggle Territories</li>
				<li class="link" onclick="Ish.Go.View.printGameState()">Print Game State</li>
			</ul>
			<div id="gameState"></div>
		</div>
	</div>

	<form id="jsonFile" name="jsonFile" enctype="multipart/form-data" method="post">

		<fieldset>
		  <h2>Json File</h2>
		   <input type='file' id='fileinput'>
		   <input type='button' id='btnLoad' value='Load' onclick='loadFile();'>
		</fieldset>
	  </form>
	  
	  
	  <script type="text/javascript">
	  
		function loadFile() {
		  var input, file, fr;
	  
		  if (typeof window.FileReader !== 'function') {
			alert("The file API isn't supported on this browser yet.");
			return;
		  }
	  
		  input = document.getElementById('fileinput');
		  if (!input) {
			alert("Um, couldn't find the fileinput element.");
		  }
		  else if (!input.files) {
			alert("This browser doesn't seem to support the `files` property of file inputs.");
		  }
		  else if (!input.files[0]) {
			alert("Please select a file before clicking 'Load'");
		  }
		  else {
			file = input.files[0];
			fr = new FileReader();
			fr.onload = receivedText;
			fr.readAsText(file);
		  }
	  
		  function receivedText(e) {
			let lines = e.target.result;
			var newArr = JSON.parse(lines); 
			console.log(newArr);
			gGameState.boardHistory = newArr;
			gGameState.boardHistoryRecord = newArr;
			gGameState.currentStep = gGameState.boardHistory.length;
			//gGameState.setBoardCopy(gGameState.boardHistory[gGameState.boardHistory.length-1]);
			//Ish.Go.View.drawBoard();
			Ish.Go.View.recall(1)
			gGameState.decidePlayer(gGameState.currentStep);
		  }

		  

		}
	  </script>
	  

</body> 
</html> 